# 最终⼀致性分布式事务概述
```c++
    典型的最终⼀致性解决⽅案如下所示

    1）TCC 解决⽅案

    2）可靠消息最终⼀致性 解决⽅案

    3）最⼤努⼒通知型 解决⽅案

    最终⼀致性分布式事务解决⽅案主要⽤于不要求结果数据时刻保持⼀致、允许存在中间状态，
但经过⼀段时间后，各个节点的数据能够达到⼀致状态的场景.


    最终⼀致性分布式事务解决⽅案的优点如下:>

        1）性能⽐较⾼，这是因为最终⼀致性分布式事务解决⽅案不要求数据时刻保持⼀致，不会因
        ⻓时间持有事务占⽤的资源⽽消耗过多的性能。

        2）具备可⽤性。

        3）适合⾼并发场景。

    最终⼀致性分布式事务解决⽅案的缺点如下:>

        1）因为数据存在短暂的不⼀致，所以在某个时刻查询出的数据状态可能会不⼀致。

        2）对于事务⼀致性要求特别⾼的场景不太适⽤。 

    
    服务模式
    最终⼀致性分布式事务解决⽅案存在4种典型的服务模式，分别为可查询操作、 幂等操作、 
    TCC操作和可补偿操作。


    TCC分布式事务的优点如下:>
        1）在应⽤层实现具体逻辑，锁定资源的粒度变⼩，不会锁定所有资源，提升了系统的性能。

        2）Confirm阶段和Cancel阶段的⽅法具备幂等性，能够保证分布式事务执⾏完毕后数据的⼀致
        性。

        3）TCC分布式事务解决⽅案由主业务发起整个事务，⽆论是主业务还是分⽀事务所在的业
        务，都能部署为集群模式，从⽽解决了XA规范的单点故障问题。

    TCC⽅案的缺点是代码需要耦合到具体业务中，每个参与分布式事务的业务⽅法都要拆分成
Try、Confirm 和 Cancel 三个阶段的⽅法，提⾼了开发成本.


        可靠消息最终⼀致性解决⽅案
可靠消息最终⼀致性分布式事务解决⽅案指的是事务的发起⽅执⾏完本地事务之后，发出⼀条
消息，事务的参与⽅，也就是消息的消费者⼀定能够接收到这条消息并处理成功.

            适⽤场景:
        可靠消息最终⼀致性⽅案主要适⽤于消息数据能够独⽴存储，能够降低系统之间耦合度，并且
    业务对数据⼀致性的时间敏感度⾼的场景.

        需要实现的服务模式:
    可靠消息最终⼀致性分布式事务解决⽅案需要实现的服务模式是可查询操作和幂等操作.

    消息最终⼀致性⽅案的可靠消息服务可以基于 本地消息表 和 消息队列中间件 两种⽅式实现.

        1.基于本地消息表实现的最终消息⼀致性⽅案
        （1）优点
        在业务应⽤中实现了消息的可靠性，减少了对消息中间件的依赖。

        （2）缺点
        1）绑定了具体的业务场景，耦合性太⾼，不可公⽤和扩展。

        2）消息数据与业务数据在同⼀个数据库，占⽤了业务系统的资源。

        3）消息数据可能会受到数据库并发性的影响。

        2.基于消息队列中间件实现的最终消息⼀致性⽅案

        （1）优点

        1）消息数据能够独⽴存储，与具体的业务数据库解耦。

        2）消息的并发性和吞吐量优于本地消息表⽅案。

        （2）缺点

        1）发送⼀次消息需要完成两次⽹络交互，⼀次是消息的发送，另⼀次是消息的提交或回滚。

        2）需要实现消息的回查接⼝，增加了开发成本。

        

```