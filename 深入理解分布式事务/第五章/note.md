## 第五章 - 分布式事务的理论知识
    从某种程度上讲，同⼀业务中通过不同的会话操作数据库，就有可能出现分布式事务问题。解决分布式事务问题需要⼀定的理论⽀撑.

**内容如下:**
* CAP 理论
* Base 理论

```c++
    CAP 理论
    CAP 是一致性(Consistency)、可用性(Availability)和分区容忍(Partition Tolerance)首字母的缩写.

    1. 一致性
      ⼀致性是指⽤户对数据的更新操作（包括新增、修改和删除），要么在所有的数据副本都执⾏成功,
      要么在所有的数据副本都执⾏失败。要求数据节点的数据副本的修改是原子操作。

      ⼀致性存在如下特点:
      1）存在数据同步的过程，应⽤程序的写操作存在⼀定的延迟。

      2）为了保证各节点数据的⼀致性，需要对相应的资源进⾏锁定，待数据同步完成后再释放锁定的资源。

      3）如果数据写⼊并同步成功，所有节点都会返回最新的数据。相反地，如果数据写⼊或者同步失败，所有节点都不会存在最新写⼊的数据。

    2.可用性
      可⽤性指的是客户端访问数据的时候，能够快速得到响应.

    可⽤性存在如下特点:
      1）所有的请求都会被响应。

      2）不会存在响应超时或者响应错误的情况。

      3）如果对不同的应⽤程序设定了超时响应时间，⼀旦超过这个时间，系统将不可⽤。

    3. 分区容忍性
      如果将存储系统部署并运⾏在多个不同的节点上,并且这些节点处于不同的⽹络中,这就形成了⽹络分区。
      此时，不可避免地会出现⽹络问题，导致节点之间的通信出现失败的情况，但是，此时的系统仍能对外提供服务，这就是分区容忍性.

      分区容忍性存在如下特点:
       1）⼀个节点挂掉，不影响其他节点对外提供服务。

       2）分区容忍性是分布式系统必须具备的基础能⼒。

    4. CAP 的组合
       (1) AP
       在实际场景中，⼤部分分布式系统会采⽤AP的⽅式，舍弃了⼀致性，这并不代表就真的放弃了⼀致性。
       此时，架构设计⽅案采⽤了最终⼀致性，允许多个节点的数据在⼀定的时间内存在差异，⼀段时间后达到数据⼀致的状态。

       (2) CP 
       在实际场景中，跨⾏转账业务需要每个银⾏系统都执⾏完转账操作的整个事务才算完成，这是典型的CP⽅式。

       (3) CA

    Base 理论

      1.Base理论概述
        Base理论是对CAP理论中AP的⼀个扩展，它通过牺牲强⼀致性来获得可⽤性。
        Base是基本可⽤（Basically Available）、软状态（Soft State）和最终⼀致性（Eventually Consistent）的缩写.

      2. 基本可用
         基本可⽤是指分布式系统出现故障时，允许其损失系统的部分可⽤性，⽐如响应时间或者功能上的损失，但是要保证系统基本可⽤.
      
      3. 软状态
         软状态是指允许系统中存在中间状态，这些中间状态不会影响系统的整体可⽤性，只是允许系统各个节点之间的数据同步存在延迟.

      4.最终一致性
        最终⼀致性是指系统中各个节点的数据副本经过⼀段时间的同步，最终能够达到⼀致的状态.
    
    
```
